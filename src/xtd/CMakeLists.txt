cmake_minimum_required(VERSION 3.20)

# Project
project(xtd_lib)
include("../../scripts/cmake/xtd_commands.cmake")
include("../../scripts/cmake/xtd_version.cmake")
add_include_directories("include")

# Generate references.cmake file
set(XTD_CMAKE_REFERENCES "references.cmake")

if (NOT (${XTD_OPERATING_SYSTEM_NAME} STREQUAL "Android" OR ${XTD_OPERATING_SYSTEM_NAME} STREQUAL "Haiku" OR ${XTD_OPERATING_SYSTEM_NAME} STREQUAL "SerenityOS" OR ${XTD_OPERATING_SYSTEM_NAME} STREQUAL "iOS"))
  file(WRITE ${XTD_CMAKE_REFERENCES} 
    "# This code was generated by CMake script.\n"
    "#\n"
    "# Changes to this file may cause incorrect behavior and will be lost if the file is regenerated.\n"
    "#\n"
    "add_references(xtd.core)\n"
    "add_references(xtd.drawing)\n"
    "add_references(xtd.forms)\n"
    "add_references(xtd.tunit)\n"
  )
else ()
  file(WRITE ${XTD_CMAKE_REFERENCES} 
    "# This code was generated by CMake script.\n"
    "#\n"
    "# Changes to this file may cause incorrect behavior and will be lost if the file is regenerated.\n"
    "#\n"
    "add_references(xtd.core)\n"
    "add_references(xtd.tunit)\n"
  )
endif ()  

# Generate xtd.hpp file
set(XTD_HEADER_FILE "include/xtd/xtd.hpp")
if (NOT (${XTD_OPERATING_SYSTEM_NAME} STREQUAL "Android" OR ${XTD_OPERATING_SYSTEM_NAME} STREQUAL "Haiku" OR ${XTD_OPERATING_SYSTEM_NAME} STREQUAL "SerenityOS" OR ${XTD_OPERATING_SYSTEM_NAME} STREQUAL "iOS"))
  file(WRITE ${XTD_HEADER_FILE} 
    "// This code was generated by CMake script.\n"
    "//\n"
    "// Changes to this file may cause incorrect behavior and will be lost if the file is regenerated.\n"
    "\n"
    "/// @file\n"
    "/// @brief Contains xtd library headers.\n"
    "/// @copyright Copyright (c) 2025 Gammasoft. All rights reserved.\n"
    "#pragma once\n"
    "#include \"xtd/xtd.core\"\n"
    "#include \"xtd/xtd.drawing\"\n"
    "#include \"xtd/xtd.forms\"\n"
    "#include \"xtd/xtd.tunit\"\n"
  )
else ()
  file(WRITE ${XTD_HEADER_FILE} 
    "// This code was generated by CMake script.\n"
    "//\n"
    "// Changes to this file may cause incorrect behavior and will be lost if the file is regenerated.\n"
    "\n"
    "/// @file\n"
    "/// @brief Contains xtd library headers.\n"
    "/// @copyright Copyright (c) 2025 Gammasoft. All rights reserved.\n"
    "#pragma once\n"
    "#include \"xtd/xtd.core\"\n"
    "#include \"xtd/xtd.tunit\"\n"
  )
endif ()  

include("references.cmake")

# Project definitions
add_sources(
  "include/xtd/xtd"
  "include/xtd/xtd.hpp"
)
target_name(xtd)
target_type(INTERFACE_LIBRARY)

# Install
add_install_include_directories("include/xtd")
install_component()
