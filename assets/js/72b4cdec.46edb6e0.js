"use strict";(self.webpackChunkxtd=self.webpackChunkxtd||[]).push([[9831],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var a=n(67294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n,a,s={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var l=a.createContext({}),u=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,s=e.mdxType,r=e.originalType,l=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),p=u(n),m=s,h=p["".concat(l,".").concat(m)]||p[m]||d[m]||r;return n?a.createElement(h,o(o({ref:t},c),{},{components:n})):a.createElement(h,o({ref:t},c))}));function m(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var r=n.length,o=new Array(r);o[0]=p;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:s,o[1]=i;for(var u=2;u<r;u++)o[u]=n[u];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},34645:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>u});var a=n(87462),s=(n(67294),n(3905));const r={},o="Events",i={unversionedId:"documentation/Guides/xtd.core/Types overview/events",id:"documentation/Guides/xtd.core/Types overview/events",title:"Events",description:"In This Section",source:"@site/docs/documentation/Guides/xtd.core/Types overview/events.md",sourceDirName:"documentation/Guides/xtd.core/Types overview",slug:"/documentation/Guides/xtd.core/Types overview/events",permalink:"/xtd/docs/documentation/Guides/xtd.core/Types overview/events",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"enum, enum class and enum struct",permalink:"/xtd/docs/documentation/Guides/xtd.core/Types overview/enum_class"},next:{title:"Preprocessor Symbols",permalink:"/xtd/docs/documentation/Guides/xtd.core/Types overview/preprocessor_symbols"}},l={},u=[{value:"In This Section",id:"in-this-section",level:2},{value:"Overview",id:"overview",level:2},{value:"How to subscribe to and unsubscribe from events",id:"how-to-subscribe-to-and-unsubscribe-from-events",level:2},{value:"To subscribe to events programmatically",id:"to-subscribe-to-events-programmatically",level:3},{value:"To subscribe to events by using a lambda expression",id:"to-subscribe-to-events-by-using-a-lambda-expression",level:3},{value:"Unsubscribing",id:"unsubscribing",level:3},{value:"To unsubscribe from an event",id:"to-unsubscribe-from-an-event",level:3},{value:"How to publish events that conform to xtd Guidelines",id:"how-to-publish-events-that-conform-to-xtd-guidelines",level:2},{value:"Publish events based on the event_handler pattern",id:"publish-events-based-on-the-event_handler-pattern",level:3},{value:"Example",id:"example",level:2},{value:"See also",id:"see-also",level:2}],c={toc:u};function d(e){let{components:t,...n}=e;return(0,s.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"events"},"Events"),(0,s.kt)("h2",{id:"in-this-section"},"In This Section"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"#overview"},"Overview")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"#how-to-subscribe-to-and-unsubscribe-from-events"},"How to subscribe to and unsubscribe from events"),(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"#to-subscribe-to-events-programmatically"},"To subscribe to events programmatically")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"#to-subscribe-to-events-by-using-a-lambda-expression"},"To subscribe to events by using a lambda expression")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"#unsubscribing"},"Unsubscribing")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"#to-unsubscribe-from-an-event"},"To unsubscribe from an event")))),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"#how-to-publish-events-that-conform-to-xtd-guidelines"},"How to publish events that conform to xtd Guidelines"),(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"#publish-events-based-on-the-event_handler-pattern"},"Publish events based on the event_handler pattern")))),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"#example"},"Example"))),(0,s.kt)("h2",{id:"overview"},"Overview"),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/classxtd_1_1event.html"},"Events")," enable a class or object to notify other classes or objects when something of interest occurs. The class that sends (or raises) the event is called the publisher and the classes that receive (or handle) the event are called subscribers.\nIn a typical xtd Windows Forms application, you subscribe to events raised by controls such as buttons and list boxes. For more information, see ",(0,s.kt)("a",{parentName:"p",href:"#how-to-subscribe-to-and-unsubscribe-from-events"},"How to subscribe to and unsubscribe from events"),"."),(0,s.kt)("p",null,"Events have the following properties:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"The publisher determines when an event is raised; the subscribers determine what action is taken in response to the event."),(0,s.kt)("li",{parentName:"ul"},"An event can have multiple subscribers. A subscriber can handle multiple events from multiple publishers."),(0,s.kt)("li",{parentName:"ul"},"Events that have no subscribers are never raised."),(0,s.kt)("li",{parentName:"ul"},"Events are typically used to signal user actions such as button clicks or menu selections in graphical user interfaces."),(0,s.kt)("li",{parentName:"ul"},"When an event has multiple subscribers, the event handlers are invoked synchronously when an event is raised."),(0,s.kt)("li",{parentName:"ul"},"In the xtd framework, events are based on the ",(0,s.kt)("a",{parentName:"li",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/group__events.html#ga0b1801aa17fa22ddacfdcccd7b25316b"},"xtd::event_handler")," ",(0,s.kt)("a",{parentName:"li",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/classxtd_1_1event__args.html"},"delegate and the xtd::event_args")," base class.")),(0,s.kt)("h2",{id:"how-to-subscribe-to-and-unsubscribe-from-events"},"How to subscribe to and unsubscribe from events"),(0,s.kt)("h3",{id:"to-subscribe-to-events-programmatically"},"To subscribe to events programmatically"),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},"Define an event handler method whose signature matches the delegate signature for the event. For example, if the event is based on the ",(0,s.kt)("a",{parentName:"li",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/group__events.html#ga0b1801aa17fa22ddacfdcccd7b25316b"},"xtd::event_handler")," delegate type, the following code represents the method stub:")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-cpp"},"void handle_custom_event(object& sender, custom_event_args& e) {  \n   // Do something useful here.  \n}  \n")),(0,s.kt)("ol",{start:2},(0,s.kt)("li",{parentName:"ol"},"Use the addition assignment operator ",(0,s.kt)("em",{parentName:"li"},"+=")," to attach an event handler to the event. In the following example, assume that an object named ",(0,s.kt)("em",{parentName:"li"},"publisher")," has an event named ",(0,s.kt)("em",{parentName:"li"},"raise_custom_event"),". Note that the ",(0,s.kt)("em",{parentName:"li"},"subscriber")," class needs a reference to the ",(0,s.kt)("em",{parentName:"li"},"publisher")," class in order to subscribe to its events")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-cpp"},"publisher.raise_custom_event += {*this, &subscriber::handle_custom_event};\n")),(0,s.kt)("p",null,"or "),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-cpp"},"publisher.raise_custom_event += custom_event_handler(*this, &my_class::handle_custom_event);\n")),(0,s.kt)("h3",{id:"to-subscribe-to-events-by-using-a-lambda-expression"},"To subscribe to events by using a lambda expression"),(0,s.kt)("p",null,"If you don't have to unsubscribe from an event later, you can use the addition assignment operator ",(0,s.kt)("em",{parentName:"p"},"+=")," to attach a ",(0,s.kt)("a",{parentName:"p",href:"#lambda-expression"},"lambda expression")," as an event handler. In the following example, assume that an object named ",(0,s.kt)("em",{parentName:"p"},"publisher")," has an event named ",(0,s.kt)("em",{parentName:"p"},"raise_custom_event and that a "),"custom_event_args",(0,s.kt)("em",{parentName:"p"}," class has also been defined to carry some kind of specialized event information. Note that the "),"subscriber",(0,s.kt)("em",{parentName:"p"}," class needs a reference to "),"publisher* in order to subscribe to its events."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-cpp"},'publisher.raise_custom_event += [](object& sender, custom_event_args& e) {  \n  xtd::string s = sender.to_string() + " " + e.to_string();  \n  console::write_line(s);  \n};\n')),(0,s.kt)("p",null,"You cannot easily unsubscribe from an event if you used a ",(0,s.kt)("a",{parentName:"p",href:"#lambda-expression"},"lambda expression")," to subscribe to it. To unsubscribe in this scenario, go back to the code where you subscribe to the event, store the anonymous function in a delegate variable, and then add the delegate to the event. We recommend that you don't use ",(0,s.kt)("a",{parentName:"p",href:"#lambda-expression"},"lambda expression")," to subscribe to events if you have to unsubscribe from the event at some later point in your code. For more information about anonymous functions, see ",(0,s.kt)("a",{parentName:"p",href:"#lambda-expression"},"lambda expression"),"."),(0,s.kt)("h3",{id:"unsubscribing"},"Unsubscribing"),(0,s.kt)("p",null,"To prevent your event handler from being invoked when the event is raised, unsubscribe from the event. In order to prevent crash, you should unsubscribe from events before you destroy a subscriber object. Until you unsubscribe from an event, the multicast delegate that underlies the event in the publishing object has a reference to the delegate that encapsulates the subscriber's event handler."),(0,s.kt)("h3",{id:"to-unsubscribe-from-an-event"},"To unsubscribe from an event"),(0,s.kt)("p",null,"Use the subtraction assignment operator ",(0,s.kt)("em",{parentName:"p"},"-=")," to unsubscribe from an event:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-cpp"},"publisher.raise_custom_event -= {*this, &subscriber::handle_custom_event};\n")),(0,s.kt)("p",null,"or"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-cpp"},"publisher.raise_custom_event -= custom_event_handler(*this, &subscriber::handle_custom_event);\n")),(0,s.kt)("p",null,"When all subscribers have unsubscribed from an event, the event instance in the publisher class is set to empty."),(0,s.kt)("h2",{id:"how-to-publish-events-that-conform-to-xtd-guidelines"},"How to publish events that conform to xtd Guidelines"),(0,s.kt)("p",null,"The following procedure demonstrates how to add events that follow the standard xtd pattern to your classes and structs. All events in the xtd framework are based on the ",(0,s.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/group__events.html#ga0b1801aa17fa22ddacfdcccd7b25316b"},"xtd::event_handler")," delegate, which is defined as follows:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-cpp"},"template<typename event_args_t = const xtd::event_args&>\nusing generic_event_handler = xtd::delegate<void(xtd::object& sender, event_args_t e)>;\n")),(0,s.kt)("p",null,"and"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-cpp"},"using event_handler = xtd::generic_event_handler<>;\n")),(0,s.kt)("p",null,"Although events in classes that you define can be based on any valid delegate type, even delegates that return a value, it is generally recommended that you base your events on the xtd pattern by using ",(0,s.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/group__events.html#ga0b1801aa17fa22ddacfdcccd7b25316b"},"xtd::event_handler"),", as shown in the following example.\nThe name event_handler can lead to a bit of confusion as it doesn't actually handle the event. The ",(0,s.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/group__events.html#ga0b1801aa17fa22ddacfdcccd7b25316b"},"xtd::event_handler"),", and generic ",(0,s.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/group__events.html#ga531b610b74cb14c6047fb0843ab686b4"},"xtd::generic_event_handler<event_args_t>")," are delegate types. A method or lambda expression whose signature matches the delegate definition is the event handler and will be invoked when the event is raised."),(0,s.kt)("h3",{id:"publish-events-based-on-the-event_handler-pattern"},"Publish events based on the event_handler pattern"),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},"(Skip this step and go to Step 3a if you do not have to send custom data with your event.) Declare the class for your custom data at a scope that is visible to both your publisher and subscriber classes. Then add the required members to hold your custom event data. In this example, a simple string is returned.")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-cpp"},"struct custom_event_args : xtd::event_args {\n  custom_event_args() = default;\n  custom_event_args(const xtd::string& message) : message_(message) {}\n  \n  xtd::string message;\n};\n")),(0,s.kt)("ol",{start:2},(0,s.kt)("li",{parentName:"ol"},"(Skip this step if you are using the generic version generic_event_handler<event_args_t>.) Declare a delegate in your publishing class. Give it a name that ends with event_handler. The second parameter specifies your custom event_args type.")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-cpp"},"using custom_event_handler = xtd::delegate<void(xtd::object& sender, custom_event_args& args)>;\n")),(0,s.kt)("ol",{start:3},(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("p",{parentName:"li"},"Declare the event in your publishing class by using one of the following steps."),(0,s.kt)("p",{parentName:"li"},"a. If you have no custom event_args class, your event type will be the non-generic event_handler delegate. You do not have to declare the delegate because it is already declared in the xtd namespace that is included when you create your xtd project. Add the following code to your publisher class."),(0,s.kt)("pre",{parentName:"li"},(0,s.kt)("code",{parentName:"pre",className:"language-cpp"},"xtd::event<publisher, xtd::event_handler> raise_custom_event;\n")),(0,s.kt)("p",{parentName:"li"},"where ",(0,s.kt)("em",{parentName:"p"},"publisher")," is the class name that contains the raise_custom_event event."),(0,s.kt)("p",{parentName:"li"},"b. If you are using the non-generic version of event_handler and you have a custom class derived from event_args, declare your event inside your publishing class and use your delegate from step 2 as the type."),(0,s.kt)("pre",{parentName:"li"},(0,s.kt)("code",{parentName:"pre",className:"language-cpp"},"xtd::event<publisher, custom_event_handler> raise_custom_event;\n")),(0,s.kt)("p",{parentName:"li"},"Where ",(0,s.kt)("em",{parentName:"p"},"publisher")," is the class name that contains the raise_custom_event event."),(0,s.kt)("p",{parentName:"li"},"c. If you are using the generic version, you do not need a custom delegate. Instead, in your publishing class, you specify your event type as generic_event_handler<custom_event_args>, substituting the name of your own class between the angle brackets."),(0,s.kt)("pre",{parentName:"li"},(0,s.kt)("code",{parentName:"pre",className:"language-cpp"},"xtd::event<publisher, generic_event_handler<custom_event_args&>> raise_custom_event;\n")),(0,s.kt)("p",{parentName:"li"},"Where ",(0,s.kt)("em",{parentName:"p"},"publisher")," is the class name that contains the raise_custom_event event."))),(0,s.kt)("h2",{id:"example"},"Example"),(0,s.kt)("p",null,"The following example demonstrates the previous steps by using a custom event_args class and genric_event_handler<event_args_t> as the event type."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-cpp"},'#include <xtd/xtd>\n\nusing namespace xtd;\n\n// Define a class to hold custom event info\nstruct custom_event_args : xtd::event_args {\n  custom_event_args() = default;\n  custom_event_args(const xtd::string& message) : message_(message) {}\n  \n  xtd::string message;\n};\n\n// Class that publishes an event\nclass publisher : public object {\npublic:\n  // Declare the event using EventHandler<T>\n  event<publisher, generic_event_handler<custom_event_args&>> raise_custom_event;\n  \n  void do_something() {\n    // Write some code that does something useful here\n    // then raise the event. You can also raise an event\n    // before you execute a block of code.\n    custom_event_args event_args("Event triggered");\n    on_raise_custom_event(event_args);\n  }\n\nprotected:\n  // Wrap event invocations inside a protected virtual method\n  // to allow derived classes to override the event invocation behavior\n  virtual void on_raise_custom_event(custom_event_args& e) {\n    // Make a temporary copy of the event to avoid possibility of\n    // a race condition if the last subscriber unsubscribes\n    // immediately after the empty check and before the event is raised.\n    event<publisher, generic_event_handler<custom_event_args&>> raise_event = raise_custom_event;\n    \n    // Event will be null if there are no subscribers\n    if (!raise_event.is_empty()) {\n      // Format the string to send inside the CustomEventArgs parameter\n      e.message(string::format("{} at {}", e.message(), date_time::now()));\n      \n      // Call to raise the event.\n      raise_event(*this, e);\n    }\n  }\n};\n\n//Class that subscribes to an event\nclass subscriber : public object {\npublic:\n  subscriber(string id, publisher& pub) : id_(id) {\n    // Subscribe to the event\n    pub.raise_custom_event += {*this, &subscriber::handle_custom_event};\n  }\n  \n  // Define what actions to take when the event is raised.\n  void handle_custom_event(object& sender, custom_event_args& e) {\n    console::write_line(string::format("{} received this message: {}", id_, e.message()));\n  }\n\nprivate:\n  string id_;\n};\n\nclass program {\npublic:\n  static auto main() {\n    publisher pub;\n    subscriber sub1("sub1", pub);\n    subscriber sub2("sub2", pub);\n    \n    // Call the method that raises the event.\n    pub.do_something();\n  }\n};\n\nstartup_(program::main);\n')),(0,s.kt)("h2",{id:"see-also"},"See also"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"/docs/documentation/Guides/Overview/Tutorials"},"Tutorials")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"/docs/documentation"},"Documentation"))))}d.isMDXComponent=!0}}]);