"use strict";(self.webpackChunkxtd=self.webpackChunkxtd||[]).push([[4272],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>p});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function d(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},s=Object.keys(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var i=n.createContext({}),l=function(e){var t=n.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},c=function(e){var t=l(e.components);return n.createElement(i.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,s=e.originalType,i=e.parentName,c=d(e,["components","mdxType","originalType","parentName"]),m=l(a),p=r,u=m["".concat(i,".").concat(p)]||m[p]||h[p]||s;return a?n.createElement(u,o(o({ref:t},c),{},{components:a})):n.createElement(u,o({ref:t},c))}));function p(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var s=a.length,o=new Array(s);o[0]=m;var d={};for(var i in t)hasOwnProperty.call(t,i)&&(d[i]=t[i]);d.originalType=e,d.mdxType="string"==typeof e?e:r,o[1]=d;for(var l=2;l<s;l++)o[l]=a[l];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},75105:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>i,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>d,toc:()=>l});var n=a(87462),r=(a(67294),a(3905));const s={},o="Handle and raise events",d={unversionedId:"documentation/Guides/xtd.core/Events/overview",id:"documentation/Guides/xtd.core/Events/overview",title:"Handle and raise events",description:"The xtd Framework events are based on the delegate model.",source:"@site/docs/documentation/Guides/xtd.core/Events/overview.md",sourceDirName:"documentation/Guides/xtd.core/Events",slug:"/documentation/Guides/xtd.core/Events/overview",permalink:"/xtd/docs/documentation/Guides/xtd.core/Events/overview",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Observer Design Pattern",permalink:"/xtd/docs/documentation/Guides/xtd.core/Events/observer_design_pattern"},next:{title:"Raise and consume events",permalink:"/xtd/docs/documentation/Guides/xtd.core/Events/raise_and_consume_events"}},i={},l=[{value:"Events",id:"events",level:2},{value:"Delegates",id:"delegates",level:2},{value:"Event data",id:"event-data",level:2},{value:"Event handlers",id:"event-handlers",level:2},{value:"Static and dynamic event handlers",id:"static-and-dynamic-event-handlers",level:2}],c={toc:l};function h(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"handle-and-raise-events"},"Handle and raise events"),(0,r.kt)("p",null,"The xtd Framework events are based on the delegate model.\nThe delegate model follows the ",(0,r.kt)("a",{parentName:"p",href:"/docs/documentation/Guides/xtd.core/Events/observer_design_pattern"},"observer design pattern"),", which allows a subscriber to register with and receive notifications from a provider.\nAn event sender sends a notification that an event has occurred, and an event receiver receives that notification and defines a response to it.\nThis article describes the main components of the delegate model, how to consume events in applications, and how to implement events in your code."),(0,r.kt)("h2",{id:"events"},"Events"),(0,r.kt)("p",null,"An event is a message sent by an object to signal the occurrence of an action.\nThe action may be caused by user interaction, such as clicking a button, or may result from other program logic, such as changing the value of a property.\nThe object that triggers the event is called the event sender.\nThe event sender does not know which object or method will receive (process) the events it raises.\nThe event is usually a member of the event sender; for example, the ",(0,r.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/classxtd_1_1forms_1_1control.html"},"click")," event is a member of the ",(0,r.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/classxtd_1_1forms_1_1control.html"},"xtd::forms::control")," class, and the ",(0,r.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/classxtd_1_1forms_1_1background__worker.html"},"progress_changed event")," is a member of the class that implements the ",(0,r.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/classxtd_1_1forms_1_1background__worker.html"},"xtd::forms::background_worker")," class."),(0,r.kt)("p",null,"To define an event, you use the ",(0,r.kt)("a",{parentName:"p",href:"/docs/documentation/Guides/xtd.core/Types%20overview/events"},"xtd::event")," class in your ",(0,r.kt)("a",{parentName:"p",href:"/docs/documentation/Guides/xtd.core/Types%20overview/events"},"event")," class signature, and you specify the delegate type for the event.\nDelegates are described in the next section."),(0,r.kt)("p",null,"In general, to trigger an event, you add a method marked as ",(0,r.kt)("inlineCode",{parentName:"p"},"protected")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"virtual"),". Name this method ",(0,r.kt)("inlineCode",{parentName:"p"},"on_event_name"),"; for example, ",(0,r.kt)("inlineCode",{parentName:"p"},"on_data_received"),".\nThe method must take a parameter that specifies an event data object, which is an object of type ",(0,r.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/classxtd_1_1event__args.html"},"xtd::event_ags")," or a derived type. You provide this method to allow derived classes to override the event trigger logic.\nA derived class must always call the ",(0,r.kt)("inlineCode",{parentName:"p"},"on_")," event_name method of the base class to ensure that the registered delegates receive the event."),(0,r.kt)("p",null,"The following example shows how to declare an event named ",(0,r.kt)("inlineCode",{parentName:"p"},"threshold_reached"),". The event is associated with the ",(0,r.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/group__events.html#ga0b1801aa17fa22ddacfdcccd7b25316b"},"xtd::event_handler")," delegate and triggered by a method called ",(0,r.kt)("inlineCode",{parentName:"p"},"on_threshold_reached"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cpp"},"class counter {\npublic: \n  xtd::event<counter, xtd::event_handler> threshold_reached;\n\nprotected:\n  virtual void on_threshold_reached(const xtd::event_args& e) {\n    xtd::event_handler handler = threshold_reached;\n    if (!handler.is_empty() handler.invoke(*this, e);\n  }\n\n  // provide remaining implementation for the class\n};\n")),(0,r.kt)("h2",{id:"delegates"},"Delegates"),(0,r.kt)("p",null,"A delegate is a type that contains a reference to a method.\nA delegate is declared with a signature that indicates the return type and parameters of the methods it references, and it can only contain references to methods that match its signature.\nA delegate is therefore equivalent to a type-safe function pointer or a callback.\nA delegate declaration is sufficient to define a class of delegates."),(0,r.kt)("p",null,"Delegates have many uses in the xtd Framework.\nIn the context of events, a delegate is an intermediary (or pointer-like mechanism) between the event source and the code that handles the event.\nYou associate a delegate with an event by including the delegate type in the event declaration, as shown in the example in the previous section.\nFor more information on delegates, see the ",(0,r.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/classxtd_1_1delegate_3_01result__t_07arguments__t_8_8_8_08_4.html"},"xtd::delegate")," class."),(0,r.kt)("p",null,"xtd provides the ",(0,r.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/group__events.html#ga0b1801aa17fa22ddacfdcccd7b25316b"},"xtd::event_handler")," and ",(0,r.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/group__events.html#ga531b610b74cb14c6047fb0843ab686b4"},"xtd::generic_event_handler<event_args_t>")," delegates to support most event scenarios.\nUse the xtd::event_handler delegate for all events that do not contain event data.\nUse the ",(0,r.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/group__events.html#ga531b610b74cb14c6047fb0843ab686b4"},"xtd::generic_event_handler<event_args_t>")," delegate for events that contain event data.\nThese delegates have no return type value and take two parameters (one xtd::object for the event source, and one object for the event data)."),(0,r.kt)("p",null,"Delegates are multicast, which means that they can contain references to more than one event handling method.\nFor more details, see the ",(0,r.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/classxtd_1_1delegate_3_01result__t_07arguments__t_8_8_8_08_4.html"},"xtd::delegate")," reference page.\nDelegates provide flexibility and fine-grained control in event processing.\nA delegate acts as an event dispatcher for the class that raises the event by maintaining a list of registered event handlers for the event."),(0,r.kt)("p",null,"For scenarios where the xtd::event_handler and ",(0,r.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/group__events.html#ga531b610b74cb14c6047fb0843ab686b4"},"xtd::generic_event_handler<event_args_t>")," delegates do not work, you can define a delegate. Scenarios that require a delegate to be defined are very rare, such as when you have to work with code that does not recognize generics.\nYou mark a delegate with the ",(0,r.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/classxtd_1_1delegate_3_01result__t_07arguments__t_8_8_8_08_4.html"},"xtd::delegate")," ",(0,r.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/classxtd_1_1delegate_3_01result__t_07arguments__t_8_8_8_08_4.html"},"xtd::delegate")," class in the declaration.\nThe following example shows how to declare a delegate named ",(0,r.kt)("inlineCode",{parentName:"p"},"threshold_reached_event_handler"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cpp"},"public:\n  using threshold_reached_event_handler = xtd::delegate<void(object& sender, const threshold_reached_event_args& e);\n")),(0,r.kt)("h2",{id:"event-data"},"Event data"),(0,r.kt)("p",null,"The data associated with an event can be provided by an event data class.\nxtd provides many event data classes that you can use in your applications.\nFor example, the ",(0,r.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/classxtd_1_1forms_1_1common__dialog.html"},"xtd::forms::dialog_closed_event_args")," class is the event data class for the ",(0,r.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/group__events.html#ga58c4d7337fff19cd20dabbd50c24298c"},"xtd::forms::common_dialog.dialog_closed")," event. xtd follows a naming pattern of ending all event data classes with _event_args.\nYou determine the event data class associated with an event by examining the event's delegate.\nFor example, the ",(0,r.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/group__events.html#ga93712f46c124e6ca40b40a2d9e14fc60"},"dialog_closed_event_handler")," delegate includes the ",(0,r.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/classxtd_1_1forms_1_1dialog__closed__event__args.html"},"dialog_closed_event_args")," class as one of its parameters."),(0,r.kt)("p",null,"The ",(0,r.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/classxtd_1_1event__args.htmlhttps://gammasoft71.github.io/xtd/reference_guides/latest/classxtd_1_1event__args.html"},"xtd::event_args")," class is the base type for all event data classes.\n",(0,r.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/classxtd_1_1event__args.html"},"xtd:event_args")," is also the class you use when an event is not associated with any data.\nWhen you create an event that is only intended to inform other classes that something has happened and does not need to pass any data, include the xtd:event_args class as the second parameter in the delegate.\nYou can pass the value ",(0,r.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/classxtd_1_1event__args.html"},"xtd::event_args::empty")," when no data is provided.\nThe ",(0,r.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/group__events.html#ga0b1801aa17fa22ddacfdcccd7b25316b"},"xtd::event_handler")," delegate includes the ",(0,r.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/classxtd_1_1event__args.html"},"xtd:event_args")," class as a parameter."),(0,r.kt)("p",null,"When you want to create a custom event data class, create a class that derives from ",(0,r.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/classxtd_1_1event__args.html"},"xtd:event_args"),", and then provide all the members needed to pass the event-related data.\nIn general, you should use the same naming scheme as xtd and end the name of your event data class with ",(0,r.kt)("inlineCode",{parentName:"p"},"_event_args"),"."),(0,r.kt)("p",null,"The following example shows an event data class named ",(0,r.kt)("inlineCode",{parentName:"p"},"threshold_reached_event_args"),"*.\nIt contains properties specific to the triggered event."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cpp"},"class threshold_reached_event_args : public xtd::event_args {\npublic: \n  int threshold() const {return threshold_;}\n  void threshold(int value) {threshold_ = value;}\n    \n  const xtd::date_time& time_reached() const {return time_reached_;}\n  void time_reached(const xtd::date_time& value) {time_reached_ = value;}\n    \nprivate:\n  int threshold_ = 0;\n  xtd::date_time time_reached_;\n};\n")),(0,r.kt)("h2",{id:"event-handlers"},"Event handlers"),(0,r.kt)("p",null,"To respond to an event, you define an event handling method in the event receiver.\nThis method must match the delegate signature of the event you are handling.\nIn the event handler, you perform the required actions when the event is triggered, such as collecting user input after the user clicks a button.\nTo receive notifications when the event occurs, your event handler method must subscribe to the event."),(0,r.kt)("p",null,"The following example shows an event handling method named ",(0,r.kt)("inlineCode",{parentName:"p"},"c_threshold_reached")," that matches the signature of the ",(0,r.kt)("a",{parentName:"p",href:"https://gammasoft71.github.io/xtd/reference_guides/latest/group__events.html#ga0b1801aa17fa22ddacfdcccd7b25316b"},"xtd::event_handler")," delegate.\nThe method subscribes to the ",(0,r.kt)("inlineCode",{parentName:"p"},"threshold_reached")," event."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cpp"},'class program {\n  static auto main() {\n    counter c;\n    c.threshold_reached += c_threshold_reached;\n\n    // provide remaining implementation for the class\n  }\n\n  static void c_threshold_reached(xtd::object& sender, const xtd::event_ergs& e) {\n    console::write_line("The threshold was reached.");\n  }\n};\n\nstartup_(program::main);\n')),(0,r.kt)("h2",{id:"static-and-dynamic-event-handlers"},"Static and dynamic event handlers"),(0,r.kt)("p",null,"xtd allows subscribers to subscribe to event notifications statically or dynamically.\nStatic event handlers are in effect for the lifetime of the class whose events they handle.\nDynamic event handlers are explicitly turned on and off during program execution, usually in response to conditional program logic.\nFor example, they can be used if event notifications are only needed under certain conditions or if an application provides multiple event handlers and the runtime conditions define which one to use.\nThe example in the previous section shows how to dynamically add an event handler.\nFor more information, see ",(0,r.kt)("a",{parentName:"p",href:"/docs/documentation/Guides/xtd.core/Types%20overview/events"},"Events"),"."),(0,r.kt)("h1",{id:"see-also"},"See also"),(0,r.kt)("p",null,"\u200b"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/documentation/Guides"},"Guides")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/documentation"},"Documentation"))))}h.isMDXComponent=!0}}]);